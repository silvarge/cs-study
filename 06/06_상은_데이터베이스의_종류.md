# 데이터베이스의 종류

현재 가장 많이 쓰이고 있는 관계형과 비관계형(NoSQL)에 대해서만 다뤄볼 예정이다.

## 관계형 데이터베이스 (RDB: Relational Database)

관계형 데이터 모델을 기초로 두고 모든 데이터를 2차원 테이블 형태로 표현하는 데이터베이스

- 행과 열을 가지는 표 형식의 데이터를 저장하는 형태의 데이터베이스
- SQL(Structured Query Language)이라는 언어를 사용하여 조작
- 데이터의 식별과 데이터로의 접근이 다른 데이터와의 관계 속에서 이루어지기 때문에 관계형 데이터라고 불린다
    - 두 테이블 이상의 관계는 외래 키를 사용하며 만들어, 연관 관계를 이룰 수 있다.
- 장단점
    - 장점
        - 명확하게 정의된 스키마
        - 데이터 무결성 보장
        - ACID(원자성, 일관성, 격리성, 영속성)을 지키기에 데이터의 신뢰도가 좋음
    - 단점
        - 상대적으로 덜 유연함 (사전에 스키마를 정의하고 시작)
        - 관계를 맺고 있기 때문에 Join이 많은 복잡한 쿼리가 만들어질 수 있다
        - 수평적 확장이 어렵고, 일반적으로 수직적 확장만이 가능
            - 수평 확장: 서버를 추가하여 데이터베이스를 분산시키는 것.
            (여러 호스트에서 하나의 데이터베이스가 작동)
            - 수직 확장: 데이터베이스의 성능을 향상시키는 것 (ex. CPU 업그레이드 등)
- 종류: MySQL, PostgreSQL, Oracle, SQL Server, MariaDB, DB2 등

## NoSQL (Not Only SQL)

관계형 데이터베이스가 아닌 다른 형태의 데이터 저장 기술을 의미.

- 데이터베이스 내에서 비정형 데이터와, 반정형 데이터를 수집, 저장, 조회하는 데 사용되는 데이터베이스 관리 시스템 접근 방식
- 사전 정의된 데이터 모델이나 일관적인 구성이 없는 데이터를 원형으로 유지하고 NoSQL 데이터베이스에 수집할 수 있음
- 집합-지향 모델의 분산 환경으로, 지연율이 낮고 처리율이 우수
- 장단점
    - 장점
        - 유연함 (언제든지 저장된 데이터를 조정하고 새로운 필드를 추가할 수 있음)
        - 애플리케이션이 필요로 하는 형식으로 데이터 저장 → 데이터 읽기 속도 빠름
        - 수직 및 수평 확장이 모두 가능
    - 단점
        - 유연함 (데이터 구조 결정을 하지 못하고 미루게 될 수 있다)
        - 일반적으로 ACID를 지원하지 않는 경우가 많음
            - 데이터 중복 허용 등, 데이터의 신뢰성이 상대적으로 낮음
            - MongoDB 처럼 ACID를 지원하는 NoSQL도 늘어나고 있는 추세
        - 데이터가 여러 컬렉션에 중복되어 있기에 수정을 해야 하는 경우 모든 컬렉션에서 수행해야 함

### Key-Value Database

키와 값으로 이루어진, 저장과 조회라는 가장 간단한 원칙에 충실한 데이터베이스

- 특징
    - 데이터가 Key와 Value의 쌍으로 저장
        - Key는 Value에 접근하기 위한 용도로 사용
        - Key는 Unique한 고유한 값으로 유지되어야 함
        - 값은 어떠한 형태의 데이터라도 담을 수 있음 (이미지, 비디오 또한 가능)
        → 데이터 입력 단계에서 검증 로직을 제대로 구현하는 것이 중요
    - 질의 속도가 빠름: 간단한 API를 제공, 단순한 구조
    - 분산 저장 시 용이
    - 테이블 간 조인을 고려하지 않음 → 외부 키/ 컬럼 별 제약 조건 등이 필요 없음
    - 저장하기 전에 어떠한 정보를 얻을 것인지, 정보에 어떻게 접근할 것인지에 대해 미리 고민이 필요
- 언제 사용하는 것이 좋을까?
    - 데이터 캐싱 (RDB 환경에서 성능 향상을 위함)
    - 장바구니 같은 웹 애플리케이션에서 일시적인 속성 추적
    - 모바일 애플리케이션용 사용자 데이터 정보와 구성 정보 저장
    - 이미지와 오디오 파일 같은 대용량 객체 저장
- 종류: **Redis**, Riak, Amazon Dynamo DB, Oracle Berkeley DB, Memcached, Voldmorte 등

### Document Database

JSON 또는 BSON, XML 과 같은 문서 형식을 이용하여 레코드를 저장

- 특징
    - _id: PK, RowID를 가짐
    - 집합적 데이터 모델: 관계형 DB에서의 여러 개 테이블 데이터를 하나의 Document에 모아둘 수 있음
    - 조회 시 한 번의 데이터 조회로 필요한 데이터 획득 가능
    - 데이터가 Key와 Document의 쌍으로 저장
        - Key-Value Database와의 차이는 값(Value)를 문서 형식의 계층형 데이터로 저장한다는 점
    - Collection > Document > JSON의 형태로 정보를 저장
        - Collection이라는 폴더 안에, Document라는 하나의 파일을 만들어서 JSON 등의 계층 형식으로 되어 있는 데이터를 저장
    - 트랜지션이 원자적으로 이루어짐
    - 데이터를 여러 서버에 분산 저장이 가능하고, 복제와 회복이 가능한 형태, 장애가 발생하더라도 대응에 유리
- 언제 사용하는 것이 좋을까?
    - 대용량 데이터를 읽고 쓰는 웹 사이트용 백엔드 지원
    - 제품처럼 다양한 속성이 있는 데이터 관리
    - 다양한 유형의 메타데이터 추적
    - JSON 데이터 구조를 사용하는 애플리케이션
    - 비정규화된 중첩 구조의 데이터를 사용하는 애플리케이션
- 종류: **MongoDB,** Azure Cosmos DB, CouchDB, MarkLogic, OrientDB 등
    - + MongoDB의 경우, ACID를 지원한다고 한다

### Graph Database

노드와 엣지로 구성된 그래프 형태의 데이터 모델 사용

- 특징
    - 데이터를 노드로 표현하며, 노드 사이의 관계를 엣지로 표현
    - 관계와 네트워크 분석에 적합
    - 데이터 시각화 하기에 좋음
    - 데이터 간의 관계가 탐색의 키일 경우 적합 (데이터 간 관계가 중요할 때)
        - 자료 간의 관계 방향 같은 것을 중점적으로 저장하고 싶을 때 사용하면 좋다
    - Graph Query Language를 사용
    - RDBMS보다 Performance가 좋다는 점 (둘 다 관계를 주로 표현하기 때문에 비교한 것)
- 언제 사용하면 좋을까?
    - Social Networks, Network Diagrams 등에 사용
    - 관계와 네트워크 분석
- 종류: **Neo4j**, Blazegraph, Infinite Graph 등

### Wide Column Database/Column-family Database(열-지향 데이터베이스)

한 객체에 관련된 모든 정보를 매우 너비가 넓은 단일 Row에 많은 컬럼 기반으로 보관

- 특징
    - 키에서 필드를 결정
        - 키는 Row(키 값)과 Column-family, Column-name을 가짐
        - 연관된 데이터는 같은 Column-family 안에 속해 있으며 각자의 Column-name을 가짐
    - 질의는 Row, Column-family, Column-name을 통해 수행
    - 대량의 데이터 압축, 분산 처리, 집계 처리, 쿼리 동작속도, 확장성이 뛰어남
    - 어떤 레코드가 어떤 열 값을 가질 지 제약이 없음, 다른 레코드에는 없는 열 값을 가지거나 가지지 않을 수도 있음
- 언제 사용하면 좋을까?
    - 레코드들의 특정 컬럼값에 대한 통계 제공 등 aggregation 기능에 강함 ← 이걸 많이 쓰면 고려해볼 만 하지 않을까?
    - 많은 양의 데이터를 빠르게 읽어야 하는 경우
- 종류: **Cassandra**, HBase, Google BigTable, HyperTable 등

### Search Engine

검색용 인덱스를 보관하기 위한 데이터베이스 (index 보관에 특화) 

- 특징
    - 평소에 사용하던 기존 DB에서 데이터를 뽑아 입력을 하면 인덱스를 생성한 후 보관
    - 대량의 텍스트 데이터를 색인화하여 검색 및 분석에 사용
- 언제 사용하면 좋을까?
    - 검색이 중요한 사이트를 만들 때
    - 로그 분석
    - 검색 엔진
- 종류: **ElasticSearch**, Apache Solr 등

# RDB vs NoSQL

## 간단 비교

|  | RDB | NoSQL |
| --- | --- | --- |
| 데이터 모델 | 테이블 (관계형) 기반 | Key-Value, Document, Graph 등 다양함 |
| 스키마 | 엄격함, 미리 정의해야 함 | 유연함, 동적으로 구조 생성 가능 |
| 트랜잭션/정합성 | ACID 보장, 데이터 일관성 우수 | 일관성보다 가용성 중시(BASE, CAP 이론 기반)<br>(일부는 ACID 지원) |
| 확장성 | 웬만해서는 수직 확장만 가능 | 수직, 수평 확장 모두 가능 |
| 데이터 중복 및 Join | 중복 최소화, 복잡한 Join 지원 | 중복 허용, Join 지원 약하거나 없음 |
| 예시 | MySQL, PostgreSQL, Oracle 등 | MongoDB, Redis, Cassandra, Neo4j 등 |
| 주요 사용처 | 고도화된 트랜잭션 시스템<br>(일반적으로 많이 사용) | 빅데이터, 실시간 분석, 유연한 개발, 분산 환경 등 |

## 언제 사용하는 것이 좋을까

### RDB

- 데이터 구조가 명확하고 변경 될 여지가 없으며, 명확한 스키마가 중요한 경우
- 중복된 데이터가 없어 변경에 용이하기에 관계를 맺고 있는 데이터가 자주 변경이 이루어지는 시스템
- 트랜잭션 등을 통해 데이터의 일관성을 엄격히 보장해야 하는 경우

### NoSQL

- 정확한 데이터 구조를 알 수 없고, 데이터가 변경/확장될 수 있는 경우
- Update가 많이 이루어지지 않는 시스템
    - 데이터 중복을 허용하기에 변경 시 모든 컬렉션에서 수정해야 함 (매우 비효율)
- 막대한 데이터를 저장해야 해서 Database를 Scale-out 해야 하는 시스템

# 외전

보다가 안 쓰기는 애매해서 추가적으로 적어봤다.

## In-Memory DB (인메모리 DB)

> 데이터 저장 위치에 따른 분류
> 

주 메모리(RAM)에 데이터를 저장하고 처리하는 데이터베이스 시스템

- 디스트 I/O 없이 메모리에서 데이터를 읽고 쓰므로 처리 속도가 빠르고 응답 시간이 짧아 실시간 응용 프로그램 및 성능이 중요한 작업에 사용
- 특징
    - 높은 성능
    - 실시간 처리
    - 캐싱
    - 복잡한 분석 및 질의
    - 일관성
- 종류
    - 인메모리 RDBMS: H2 Database, VoltDB
    - 인메모리 NoSQL: Redis, Memcached

### 기존 데이터베이스와 인메모리 데이터베이스 비교

- 기존 데이터베이스
    - 디스크 기반 데이터베이스
    - 자주 불러오는 데이터 일부만을 메모리에 저장하여 사용하는 구조
    - 메모리는 성능상의 이유로 캐시 방식을 이용해 DB Read 부하를 감소시키는 목적으로 주로 사용됨
    - 대부분의 데이터는 디스크에 보관하고 테이프와 같은 매체에 백업
- 인메모리 데이터베이스
    - 데이터 갱신 자체를 메모리를 사용하고 백업과 로그 생성을 디스크를 이용

## 시계열 데이터베이스(TSDB; Time Series Database)

시계열 데이터를 처리하기 위해 최적화된 데이터베이스

- 빠르고 정확하게 실시간으로 쌓이는 대규모 데이터를 처리하기 위해 고안
- 시간의 흐름에 따라 데이터를 분석하기에 용이
- 과거의 데이터를 시간과 함께 기록용으로 저장하므로 주된 작업은 INSERT와 DELETE
- 특징
    - 시간을 기반으로 하는 저장 공간: timestamp를 기반으로 하는 저장소
    - 빠른 처리 속도: 시간에 따라 축적된 데이터들에 최적화되어, TSDB에서의 인덱스는 빠른 처리 속도를 보임
    - 다양한 자동화된 기능 제공
    - INSERT와 SELECT에 최적화되어 DELETE, UPDATE에 대한 기능이 제한됨
    - 시간에 따라 오름차순으로 정렬 → 임의의 시간으로 데이터를 읽고 쓰는 작업은 성능이 떨어짐
    - DB에 부하가 걸린 경우 항상 최신의 데이터를 반환하지 못할 수 있다
- 종류: **InfluxDB** 등

## NewSQL

빅데이터와 클라우드 기반의 확장형 아키텍처가 대두되면서, 기존의 RDB와 NoSQL은 각자의 장단점으로 인해 다양한 선택지를 제공했다.
하지만, 두 가지 모두에서 일관성과 확장성 간의 균형을 찾는 것은 매우 어려운 상태였다는 것.

⇒ 이러한 한계를 극복하기 위해 등장한 NewSQL!

전통적인 관계형 모델을 유지하면서도 NoSQL이 제공하는 수평 확장성과 고성능 처리 능력을 갖춘 차세대 데이터베이스 시스템이라는 이름으로 나타났다. (2011년에 나타남)

- 특징
    - 관계형 모델 유지: SQL 문법 사용, 정규화된 테이블 구조
    - 수평 확장 지원: 클러스터 기반으로 노드를 추가해 성능 확장 가능
    - ACID 보장: 분산 환경에서도 트랜잭션 일관성과 원자성 보장
    - 고성능 처리: 메모리 기반 처리, 비동기 I/O, MVCC 등의 최신 기술 활용
    - 클라우드 최적화: 자동 장애 복구, 멀티 리전 동기화, 스케일 아웃 아키텍처 등
- 언제 사용해야 할까?
    - 수평 확장이 필요한 클라우드 기반의 글로벌 서비스
    - 실시간 분석과 트랜잭션이 동시에 요구되는 플랫폼
    - 기존 RDBMS의 스케일링 한계를 경험하고 있는 경우
    - NoSQL의 eventual consistency(궁극적 일관성)가 비즈니스에 리스크가 되는 경우
- 한계점과 현실적인 제약 사항
    - 도입 난이도: 분산 시스템 틍성 상 초기 구축 복잡할 수 있음
    - 운영 경험 부족: RDBMS, NoSQL에 비해 상대적으로 운영 경험과 커뮤니티 자료가 적음
    - 쿼리 성능 최적화: SQL을 사용하더라도 내부 아키텍처는 RDBMS와 달라 튜닝 방식이 다를 수 있다는 점
    - 마이그레이션 비용: 기존 RDBMS에서 데이터 이전 시 스키마 설계와 동기화 이슈 고려 필요
- 종류: Google Spanner, CockroachDB, TiDB, VoltDB 등
    - CockroachDB의 경우 PostgreSQL과 호환된다고 한다

🙋 개인적인 생각: NewSQL을 기존 RDBMS 등을 대체하여 도입할 만큼의 메리트는 없는 것 같다… RDBMS는 계속 발전해나가고 있고, 복잡도가 높다면 상당히 리스크가 크지 않을까? CockroachDB는 또 PostgreSQL과 호환된다고 하니 궁금할 때 한 번 어떤지 보기 위해 건드려보는 것 정도는 좋을 것 같다.

# 참고 자료

https://db-engines.com/en/ranking

https://www.mongodb.com/ko-kr/resources/basics/databases/nosql-explained/nosql-vs-sql

https://k-sky.tistory.com/776

https://sbp-it.tistory.com/276

https://comdon-ai.tistory.com/113#%EC%B6%9C%EC%B2%98

https://bestpractice80.tistory.com/66

https://velog.io/@swhan9404/NoSQL-%EC%9D%98-%EC%A2%85%EB%A5%98%EB%B3%84-%ED%8A%B9%EC%A7%95

https://khj93.tistory.com/entry/Database-RDBMS%EC%99%80-NOSQL-%EC%B0%A8%EC%9D%B4%EC%A0%90

https://mangkyu.tistory.com/188

https://happy-jjang-a.tistory.com/328

https://velog.io/@park2348190/%EC%96%B8%EC%A0%9C-NoSQL%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94%EA%B2%8C-%EC%A2%8B%EC%9D%84%EA%B9%8C

https://somaz.tistory.com/406

https://blog.skby.net/newsql/
