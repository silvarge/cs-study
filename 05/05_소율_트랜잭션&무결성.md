## 1) 트랜잭션(Transaction)

- **정의**: 데이터베이스에서 **하나의 논리적 기능을 수행하는 작업 단위**
- 여러 쿼리를 하나로 묶어서 **원자적 실행 단위**로 보장
- `COMMIT`: 모든 작업을 영구 저장
- `ROLLBACK`: 오류 시 모든 작업을 원래 상태로 복구
- 커밋과 롤백으로 데이터 무결성 보장
## 2) 트랜잭션 특징 (ACID)

1. **원자성 (Atomicity)**
    - 트랜잭션 단위로 **모두 수행되거나, 전혀 수행되지 않아야 함**
    - 실패 시 → ROLLBACK : 모두 수행되지 않음을 보장
    - 주의: 트랜잭션 내부에서 **외부 API 호출**은 롤백 불가 → 해결방법 필요
    - 트랜잭션 전파 신경써서 관리해야함
    - cf)트랜잭션 전파: 커넥션 단위로 수행하기 때문에 커넥션 객체를 넘겨서 수행해야함. 매번 넘겨주기가 어렵고 귀찮아서 넘겨서 수행하지 않고 여러 트랜잭션 관련 메서드의 호출을 하나의 트랜잭션에 묶이도록 하는 것
2. **일관성 (Consistency)**
    - 허용된 규칙과 제약조건을 위반하지 않고 항상 **데이터 무결성** 유지
    - 예: 계좌 이체 시, 출금과 입금 합이 일정해야 함
3. **격리성 (Isolation)**
    - 동시에 실행되는 트랜잭션은 **서로 간섭하지 않고 독립적**
    - 마치 **순차적으로 실행되는 것처럼 보장**
   <img width="489" height="315" alt="스크린샷 2025-09-11 오후 3 47 29" src="https://github.com/user-attachments/assets/7f470fc5-b1cc-46c6-8be0-e5ebc581a660" />
  ### 격리 수준 (Isolation Level)

| 수준 | 특징 | 발생 가능 문제 |
| --- | --- | --- |
| **READ UNCOMMITTED** | 커밋되지 않은 데이터 읽기 가능 → 가장 빠름, 가장 낮은 수준,무결성을 위해 사용하지 말기 | 더티 리드, 반복불가 조회, 팬텀 리드 |
| **READ COMMITTED** | 커밋된 데이터만 읽음, 어떤 트랜잭션이 접근한 행을 다른 트랜잭션이 수정할 수 있음 → 가장 많이 사용 | 반복불가 조회, 팬텀 리드 |
| **REPEATABLE READ** | 하나의 트랜잭션이 수정한 행을 다른 트랜잭션이 수정할수없도록 막아주지만 새로운 행을 추가하는 것은 막지 않음. | 팬텀 리드 |
| **SERIALIZABLE** | 트랜잭션 순차적 실행 보장, 여러 트랜잭션이 동시에 같은 행에 접근 불가→ 가장 엄격, 성능 저하 | 교착상태 가능 |

### 발생하는 현상

- **더티 리드 (Dirty Read)**: 커밋 전 데이터를 읽음
- **반복 불가능한 조회 (Non-Repeatable Read)**: 동일 행을 두 번 조회했는데 값이 다름
- **팬텀 리드 (Phantom Read)**: 동일 쿼리 결과가 다르게 나옴 (새로운 행 추가됨)
4. **지속성 (Durability)**
    - 성공적으로 커밋된 트랜잭션은 **영구 반영**
    - 장애 발생 시에도 회복 가능
    - 기법: 체크섬(중복 검사 한 형태, 오류 정정으로 송신된 자료의 무결성 보호), 저널링(파일 시스템 또는 DB시스템에 변경사항을 반영하기 전 로깅)
## 3) 무결성(Integrity)

- 데이터의 **정확성, 일관성, 유효성 보장**
- DB 값이 현실 세계의 실제 값과 일치해야 신뢰 확보

### 무결성 종류

1. **개체 무결성(Entity Integrity)**: 기본키는 NULL 불가
2. **참조 무결성(Referential Integrity)**: 외래키는 참조하는 기본키 값과 일치해야 함
3. **고유 무결성(Unique Integrity)**: 조건이 주어진 경우, 특정 속성 값은 고유해야 함 (UNIQUE 제약)
4. **NULL 무결성**: 특정 속성은 NULL 불가 (NOT NULL 제약)
